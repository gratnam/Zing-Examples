<html>

<head>
  <script src="https://cdn.zingchart.com/zingchart.min.js"></script>
  <script>
    zingchart.MODULESDIR = "https://cdn.zingchart.com/modules/";
    ZC.LICENSE = ["569d52cefae586f634c54f86dc99e6a9", "ee6b7db5b51705a13dc2339db3edaf6d"];
  </script>
  <script>
    zingchart.loadModules('maps,maps-usa');
  </script>
  <style>
    #myChart {
    margin-left: 100;
    margin-top: 40px;
    }
  </style>
</head>

<body>
  <div id='myChart'></div>
  <script>
    zingchart.THEME = "classic";
    var myConfig = {
      "background-color": "white",
      "title": {
        "text": "US States with Carbon Emissions over 100 Million Metric Tons",
        "background-color": "none",
        "color": "#666666",
        "font-size": "28px",
        "font-family": "arial",
        "text-align": "left"
      },
      "subtitle": {
        "text": "Select a year bubble to view states",
        "background-color": "none",
        "color": "#666666",
        "font-size": "18px",
        "font-family": "arial",
        "text-align": "left",
        "bold": "false",
        "margin-top": "10%"
      },
      "source": {
        "text": "Source: http://www.eia.gov/environment/emissions/state/analysis/pdf/table1.pdf",
        "font-family": "arial",
        "bold": "false",
        "color": "#666666"
      },
      "shapes": [{
        "type": "zingchart.maps",
        "options": {
          "id": "map",
          "name": "usa",
          "scale": true,
          "x": "7%",
          "y": "20%",
          "width": "100%",
          "height": "86%",
          "style": {
            "background-color": "#ebebeb",
            "label": {
              "visible": 0
            },
            "tooltip": {
              "border-radius": "0"
            }
          }
        }
      }, {
        "type": "circle",
        "id": "2000",
        "size": 10,
        "x": "5%",
        "y": "27%",
        "border-width": "1px",
        "border-color": "#a5a5a5",
        "background-color": "#5e3533",
        "label": {
          "text": "2000",
          "offset-x": 30,
          "font-family": "arial",
          "font-color": "#666666"
        }
      }, {
        "type": "circle",
        "id": "2002",
        "size": 10,
        "x": "5%",
        "y": "37%",
        "background-color": "#6f3e3c",
        "border-width": "1px",
        "border-color": "#a5a5a5",
        "label": {
          "text": "2002",
          "offset-x": 30,
          "font-family": "arial",
          "font-color": "#666666"
        }
      }, {
        "type": "circle",
        "id": "2004",
        "size": 10,
        "x": "5%",
        "y": "47%",
        "background-color": "#7f4845",
        "border-width": "1px",
        "border-color": "#a5a5a5",
        "label": {
          "text": "2004",
          "offset-x": 30,
          "font-family": "arial",
          "font-color": "#666666"
        }
      }, {
        "type": "circle",
        "id": "2006",
        "size": 10,
        "x": "5%",
        "y": "57%",
        "background-color": "#90514e",
        "border-width": "1px",
        "border-color": "#a5a5a5",
        "label": {
          "text": "2006",
          "offset-x": 30,
          "font-family": "arial",
          "font-color": "#666666"
        }
      }, {
        "type": "circle",
        "id": "2008",
        "size": 10,
        "x": "5%",
        "y": "67%",
        "background-color": "#a15a57",
        "border-width": "1px",
        "border-color": "#a5a5a5",
        "label": {
          "text": "2008",
          "offset-x": 30,
          "font-family": "arial",
          "font-color": "#666666"
        }
      }, {
        "type": "circle",
        "id": "2010",
        "size": 10,
        "x": "5%",
        "y": "77%",
        "background-color": "#ac6865",
        "border-width": "1px",
        "border-color": "#a5a5a5",
        "label": {
          "text": "2010",
          "offset-x": 30,
          "font-family": "arial",
          "font-color": "#666666"
        }
      }, {
        "type": "circle",
        "id": "2012",
        "size": 10,
        "x": "5%",
        "y": "87%",
        "background-color": "#b57976",
        "border-width": "1px",
        "border-color": "#a5a5a5",
        "label": {
          "text": "2012",
          "offset-x": 30,
          "font-family": "arial",
          "font-color": "#666666"
        }
      }]
    };

    zingchart.render({
      id: 'myChart',
      data: myConfig,
      height: 500,
      width: 900
    });

    // Keep track of last shape clicked
    var lastClick = null;

    // Population data for updating the chart
    var population = {
      "2000": {
        "states": ['TX', 'CA', 'PA', 'IL', 'OH', 'FL', 'IN', 'LA', 'NY', 'MI', 'KY', 'GA', 'MI', 'NC', 'AL', 'NJ', 'VA', 'WI', 'TN', 'WV', 'MN'],
        "bgColor": "#5e3533"
      },
      "2002": {
        "states": ['TX', 'CA', 'PA', 'IL', 'OH', 'FL', 'IN', 'LA', 'NY', 'MI', 'KY', 'GA', 'MI', 'NC', 'AL', 'NJ', 'VA', 'WI', 'TN', 'WV', 'MN'],
        "bgColor": "#6f3e3c"
      },
      "2004": {
        "states": ['TX', 'CA', 'PA', 'IL', 'OH', 'FL', 'IN', 'LA', 'NY', 'MI', 'KY', 'GA', 'MI', 'NC', 'AL', 'NJ', 'VA', 'WI', 'TN', 'WV', 'MN'],
        "bgColor": "#7f4845"
      },
      "2006": {
        "states": ['TX', 'CA', 'PA', 'IL', 'OH', 'FL', 'IN', 'LA', 'NY', 'MI', 'KY', 'GA', 'MI', 'NC', 'AL', 'NJ', 'VA', 'WI', 'TN', 'WV', 'MN', 'OK'],
        "bgColor": "#90514e"
      },
      "2008": {
        "states": ['TX', 'CA', 'PA', 'IL', 'OH', 'FL', 'IN', 'LA', 'NY', 'MI', 'KY', 'GA', 'MI', 'NC', 'AL', 'NJ', 'VA', 'WI', 'TN', 'WV', 'MN', 'OK', 'AZ'],
        "bgColor": "#a15a57"
      },
      "2010": {
        "states": ['TX', 'CA', 'PA', 'IL', 'OH', 'FL', 'IN', 'LA', 'NY', 'MI', 'KY', 'GA', 'MI', 'NC', 'AL', 'NJ', 'VA', 'TN'],
        "bgColor": "#ac6865"
      },
      "2012": {
        "states": ['TX', 'CA', 'PA', 'IL', 'OH', 'FL', 'IN', 'LA', 'NY', 'MI', 'KY', 'GA', 'MI', 'NC', 'AL', 'NJ', 'VA', 'WI', 'TN', 'WV', 'MN', 'OK'],
        "bgColor": "#b57976"
      }
    };

    // Returns the styled items object
    function createItems(year) {
      var data = population[year];
      var items = {};
      data.states.forEach(function(state) {
        var stateItem = {
          "background-color": data.bgColor,
          "border-color": "#a5a5a5",
          "border-width": 1,
          "label": {
            "visible": 0
          },
          "hover-state": {
            "visible": false
          },
          "tooltip": {
            "border-radius": "0"
          }
        }
        items[state] = stateItem;
      });
      return items;
    }

    // Deep copy a Javascript object
    function copy(obj) {
      return JSON.parse(JSON.stringify(obj));
    }

    // Bind the shapeclick
    zingchart.shape_click = function(p) {
      var year = p.shapeid;
      if (Object.keys(population).indexOf(year) < 0) {
        return;
      }
      if (lastClick == year) {
        lastClick = null;
        zingchart.exec('myChart', 'setdata', {
          data: myConfig
        });
      } else {
        lastClick = year;
        var newData = copy(myConfig);
        newData.shapes[0].options.style.items = createItems(year);
        zingchart.exec('myChart', 'setdata', {
          data: newData
        });
      }
    }
  </script>
</body>

</html>